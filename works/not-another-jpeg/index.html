<!DOCTYPE html>
<html lang="en">

<html>
  <head>
    <title>Not another JPEG</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link type="text/css" rel="stylesheet" href="../../main.css">
  </head>

<body>
  
<div class="workgrid">
   <!-- Row 0 -->
  <div class = "fullwidthitem">
  <br>
  <h4><a href="../../index.html">Menu</a></h4>
 <!--  <script>
    document.write('<h4><a href="' + document.referrer + '">Menu</a></h4>');
  </script> -->

  </div>
   <!-- Row 1 -->
  <div class = "twothirdsitem">
  <h1><i>Not another JPEG</i></h1>
  <h5>2021<br>
    <br>
    JPEG file</h5>
      <br>
    <br>

  <!-- image decoder -->
  <p id="decoderOutput"></p>


  <script type="text/javascript" src="f5extract.min.js"></script>



  <script type="text/javascript">
   // NOTE - I embedded a .txt file into the image test.jpeg simply by putting it into the demo site for f5stego.js. http://desudesutalk.github.io/f5stegojs/
   //(i may have done this step wrong)

    var req = new XMLHttpRequest(); //we need to get the jpeg data from the server, so we set up a request
    req.open("GET", '/works/not-another-jpeg/test2.jpeg', true);
    req.responseType = "arraybuffer";

    req.onload = function () { // we write a function that gets called when the request returns
      var rawImageData = new Uint8Array(req.response);

      //from f5stego
      
      var password = 'notanotherjpeg'; //password from encoder page

      var stegKey = new Uint8Array(password.length); //convert the password string to an array of codepoints
      for (var i = 0; i < password.length; i++) {
        stegKey[i] = password.charCodeAt(i);
      }
      
      var f5get = f5extract(stegKey);
      var unit8message = f5get(rawImageData);
      
      //make into string and display on webpage
      var strMessage = new TextDecoder().decode(unit8message)
      document.getElementById("decoderOutput").innerHTML = strMessage;
    };

    req.send(null); // and then we send the request!

  </script>
  </div>
  <div class = "item">
  </div>


<!-- Row 2 -->
  <div class = "fullwidthitem">
    <div class = "c1 hideContent">
    <p>testing</p>
    </div>
  </div>

  <!-- Row 3 -->
  <div class = "fullwidthitem">
    <div class = "c2 hideContent">
    <img src="https://cloudflare-ipfs.com/ipfs/QmZQ6D89qxQzT13pGGSFFNzg3Uia5bzaZdALafZLtJzbbo" alt="image stored on IPFS" width = 100%>
    </div>
  </div>

    <!-- Row 2 -->
  <div class = "fullwidthitem">
    <span class="subheader c1" onclick="switchVisible(this)"><a>Decoded Text</a></span> //
    <span class="subheader c2" onclick="switchVisible(this)"><a>Original Image</a></span>
  </div>


  <script>
function switchVisible(el) {
  var classN = el.classList.value.split(' ')[1];
  if(classN == 'c1'){
    document.querySelector('.workgrid .c1').classList.toggle('hideContent');
  }
  else if(classN == 'c2'){
    document.querySelector('.workgrid .c2').classList.toggle('hideContent');
  }
  var arrayOfElements = document.querySelectorAll('.menugrid div').forEach(function(div,i){
    if(!div.classList.value.includes(classN) && !div.classList.value.includes('hideContent')){
      div.classList.toggle('hideContent');
    }
  });
}
</script>


   <!-- Row 4 -->
  <div class = "fullwidthitem">
    <h4><a href="../../index.html">Menu</a></h4>
  <!-- <script>
    document.write('<h4><a href="' + document.referrer + '">Menu</a></h4>');
  </script> -->
  <br>
  </div>
  
</div>



</body>
</html>



